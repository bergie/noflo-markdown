topic: "markdown/ToMarkdown"
name: "HTML-to-Markdown conversion"
timeout: 10000
fixture:
 type: 'fbp'
 data: |
  # @runtime noflo-nodejs
  INPORT=c.IN:IN
  OUTPORT=r.OUT:OUT

  c(markdown/ToMarkdown) OUT -> IN r(core/Repeat)
cases:
-
  name: 'When receiving a Markdown string'
  assertion: 'Generated HTML should be sent out'
  inputs:
    in: '<p>I am using <strong>markdown</strong>.</p>'
  expect:
    out:
      equals: "I am using **markdown**.\n"
-
  name: 'When receiving HTML with DIVs'
  assertion: 'Generated Markdown should be sent out with DIVs stripped'
  inputs:
    in: "<div class='foo'><p>I am <span>using</span> <strong>markdown</strong>.</p></div>"
  expect:
    out:
      equals: "I am using **markdown**.\n"
-
  name: 'When receiving HTML with IFRAMEs'
  assertion: 'Generated Markdown should be sent out with IFRAME kept'
  inputs:
    in: "<h1>Hello world</h1><iframe src=\"//player.vimeo.com/video/99873002?color=ffffff\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>"
  expect:
    out:
      equals: "Hello world\n===\n\n<iframe src=\"//player.vimeo.com/video/99873002?color=ffffff\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen=\"\" mozallowfullscreen=\"\" allowfullscreen=\"\"></iframe>\n"
